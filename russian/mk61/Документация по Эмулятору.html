<!DOCTYPE html>
<html lang="ru">

<head>
	<title>Описание возможностей эмулятора ПМК-61</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta content="true" name="HandheldFriendly"/>
	<meta content="width" name="MobileOptimized"/>
	<meta content="yes" name="apple-mobile-web-app-capable"/>
	<meta name="description" content="Описание возможностей эмулятора ПМК-61"/>

<style>

.code {
	background-color:#103810;
	color:#77FF77;
	font-size:1.1em;
	font-family:monospace;
	font-weight:bold;
	padding:1px 2px 1px 2px;
	white-space:pre;
}

table {
	border-collapse:collapse;
}

table, th, td {
	border:1px solid black;
}

.center {
	text-align:center;
}


</style>

</head>

<body>
	<header>
		<h1>Описание возможностей эмулятора ПМК-61</h1>
	</header>
	<section>
		<h2>Кратко о возможностях</h2>
		<p>
			Этот эмулятор, использующий JavaScript (т. е. совместимый с 
			большинством браузеров), можно использовать для написания и отладки
			программ под ПМК-61, используя дополнительные возможности, 
			которые недоступны в реальном калькуляторе:
		</p>
		<ul>
			<li>
				Отображение содержимого регистров памяти, стека исполнения,
				стека адресов возврата, текущего счётчика команд.
			</li>
			<li>
				Команды по выводу/вводу состояния калькулятора в целом (вместе
				с содержимым). Приостановка работы. Ускоренный режим работы.
			</li>
			<li>
				Текстовое поле для ввода команд
				для программного режима. Подсветка, вывод только кодов.
			</li>
		</ul>
	</section>
	
	<section>
		<h2>Базовые возможности</h2>
		<p>
			Сам калькулятор отображён близко к тому, как он выглядит в реальности.
			Кнопки можно нажимать мышкой, чтобы выполнять стандартные операции.
		</p>
		<p>
			Кроме того, можно использовать «горячие» клавиши 
			(кроме кнопки включения), которые 
			отображаются как подсказки над каждой кнопкой.
			«Горячие» клавиши не работают, когда фокус в поле ввода кода программы.
			Они также не зависят от раскладки языка, состояния CapsLock и NumLock.
			Фактически, зависят от физического расположения клавиши на клавиатуре.
			Цифры 0&hellip;9 работают как на основной, так и на дополнительной клавиатуре.
			Операции «&minus;», «+» &ndash; так же. На основной это правее цифры 9.
			Операция «*» только на дополнительной клавиатуре, т. к. на основной
			она совмещена с «8». Знак деления на основной (на дополнительной
			и так видно) клавиатуре обычно расположен снизу 
			возле правого Shift (после буквы «Ю»). Левее него идут знаки 
			«.» или «,» (оба понимаются как «.»). На дополнительной клавиатуре
			очевидно снизу. Знак «~» (для смены знака) там, где буква Ё, обычно 
			под Esc.
		</p>
	</section>
	
	<section>
		<h2>Отображение содержимого регистров памяти</h2>
		<p>
			Содержимое 15 (R0&hellip;RE) регистров памяти отображается в 
			форме: цифры мантиссы,
			и если есть порядок, то символ «^» (разделения порядка), а если 
			порядок содержит шестнадцатеричные цифры, то они отображаются через 
			дополнительный разделительный символ «|». В последнем случае именно
			такой вид порядок будет отображён при выводе
			его на экран. Числовое значение до знака «|» показывает его 
			фактическое значение (с точки зрения калькулятора).
		</p>
		<p>
			Приведём пример в виде таблицы, где будем указывать вводимые команды,
			содержимое основного экрана калькулятора и поле регистра X 
			(оно шире, чем на экране, по указанной вверху причине).
			Не забывайте, что это полный эмулятор калькулятора, а значит он
			эмулирует все «особенности» физического калькулятора.
		</p>
		<table>
			<tr>
				<th>Ввод</th>
				<th>Экран</th>
				<th>Регистр X</th>
				<th>Комментарий</th>
			</tr>
			<tr>
				<td class="center">5 0</td>
				<td><span class="code"> 50.         </span></td>
				<td><span class="code"> 50.              </span></td>
				<td>Просто ввод числа 50.</td>
			</tr>
			<tr>
				<td class="center">F10<sup>x</sup></td>
				<td><span class="code"> 1.        50</span></td>
				<td><span class="code"> 1.       ^ 50    </span></td>
				<td>Обратите внимание, что в поле появился разделитель порядка.</td>
			</tr>
			<tr>
				<td class="center">Fx<sup>2</sup></td>
				<td><span class="code"> ЕГГ0Г       </span></td>
				<td><span class="code"> 1.       ^100    </span></td>
				<td>
					На основном экране отобразится код ошибки из-за 
					переполнения порядка (более 99), но в поле
					будет показано число с порядком 100, т. е. фактически 
					калькулятор может его использовать, хотя и не может 
					его показывать.
				</td>
			</tr>
			<tr>
				<td class="center">Fx<sup>2</sup></td>
				<td><span class="code"> 3ГГ0Г       </span></td>
				<td><span class="code"> 1.       ^200    </span></td>
				<td>
					Порядок увеличился. Начинаются известные из 
					<a href="https://ru.wikipedia.org/wiki/Еггогология" target="_blank">
						Еггогологии
					</a>
					ЗГГОГи и их «особенности» &ndash; в стеке адресов возврата
					появилось ненулевое значение.
				</td>
			</tr>
			<tr>
				<td class="center">Fавт</td>
				<td><span class="code"> 3ГГ0Г       </span></td>
				<td><span class="code"> 1.       ^200    </span></td>
				<td>Без изменений.</td>
			</tr>
			<tr>
				<td class="center">.</td>
				<td><span class="code"> 3ГГ0Г    200</span></td>
				<td><span class="code"> 1.       ^ 57|--3</span></td>
				<td>
					Команда «.», и вот он(!) известный способ заставить 
					калькулятор отобразить на экране значение сверхчисла. 
					Но глядя на поле регистра видно, 
					что	фактически это уже другое число, не очень большое, но с 
					порядком, содержащим шестнадцатеричные цифры.
				</td>
			</tr>
			<tr>
				<td class="center">Fавт</td>
				<td><span class="code"> 1.       --3</span></td>
				<td><span class="code"> 1.       ^ 57|--3</span></td>
				<td>Вот мы этот порядок и проявили явно.</td>
			</tr>
			<tr>
				<td class="center">0 +</td>
				<td><span class="code"> 1.        57</span></td>
				<td><span class="code"> 1.       ^ 57    </span></td>
				<td>А сложив с нулём, ещё и узнали фактическое значение.</td>
			</tr>
		</table>
		<p>
			И кстати, в документе
			<a href="Недокументированные%20возможности%20ПМК%20МК-61.html#id_indirect_addr_exponent" target="_blank">
				про недокументированные особенности</a
			> указано правило 160, по которому в данном случае порядок &minus;103
			(&minus;«&minus;3» = &minus;«A3» = &minus;«103») 
			превращается в 57-й.
		</p>
		<p>
			Стек адресов возврата начинается снизу (как стек данных). Во время
			выполнения он может временно отображать «мусор». При остановке всё 
			нормализуется.
		</p>
	</section>
	
	<section>
		<h2>Состояние</h2>
		<p>
			Кнопка «Прочитать» позволяют прочитать всё содержимое ПМК в 
			виде одной строки (автоматического копирования в буфер обмена
			не производится, чтобы не иметь проблем с безопасностью). Её 
			можно не интерпретировать, считайте это бинарное состояние, но в
			виде текста. 
		</p>
		<p>
			Если требуется прочитать состояние при работающей программе, можно
			использовать кнопку «Стоп», которая остановит работу ПМК (без сброса
			переменных).
		</p>
		<p>
			Позднее в любой момент можно «Ввести» сохранённую строку состояния 
			обратно, восстановив все регистры и программу. Если ПМК до этого 
			был выключен, то он автоматически включится.
		</p>
		<p>
			Ускоренный режим в 10-15 раз ускоряет выполнение, но вглядеться в 
			индикацию на основном экране ПМК, что используется в некоторых
			играх, будет уже затруднительно. По умолчанию (после включения)
			этот режим выключен.
		</p>
	</section>
	
	<section>
		<h2>Код программы</h2>
		<p>
			Это самое интересное в эмуляторе.
		</p>
		<p>
			Начнём с вывода. По кнопке «Прочитать из памяти» программа 
			будет выведена в псевдокодах (см. далее) в поле для редактирования.
			Выводимый текст может при этом быть специальным образом отформатирован,
			в зависимости от установки флагов под этим полем:
		</p>
		<ul>
			<li>
				<b>Простой код.</b> По умолчанию включён. В этом случае выводятся
				только команды, без адреса. Форматируется по 10 команд в строку 
				с равномерным отступами для лучшего чтения. Если флаг сброшен, то
				каждая команда предваряется адресом (с точкой), для удобства 
				восприятия уменьшенным шрифтом и неярким цветом.
			</li>
			<li>
				<b>Подсветка.</b> По умолчанию включён. 
				В этом случае каждая команда раскрашивается, в зависимости 
				от типа:
				<table>
					<tr>
						<td style="color:#A0A000;">Цитрусовый цвет</td>
						<td>
							Используется для операций со стеком и пустых операторов.
						</td>
					</tr>
					<tr>
						<td style="color:#00A000;">Истинно зелёный цвет</td>
						<td>
							Используется для операций работы с регистрами памяти,
							в том числе косвенными.
						</td>
					</tr>
					<tr>
						<td style="color:#A00000;">Глубокий красный цвет</td>
						<td>
							Используется для всех функций и операций. 
							F<span style="font-size:large;">&pi;</span>
							считается функцией.
						</td>
					</tr>
					<tr>
						<td style="color:#0000A0;">Королевский синий цвет</td>
						<td>
							Используется для операторов, которые могут изменить
							порядок выполнения. Условные и безусловные переходы,
							операторы сравнения. Команды остановки и возврата.
						</td>
					</tr>
					<tr>
						<td style="color:#000000;">Обычный чёрный цвет</td>
						<td>
							Используется для операторов ввода числа, т. е. цифр,
							ввода порядка, смены знака, точки.
						</td>
					</tr>
					<tr>
						<td style="color:#A000A0; text-decoration: underline;">
							Барни фиолетовый с подчёркиванием
						</td>
						<td>
							Используется для числовых значений адресов перехода 
							после операторов сравнения, циклов или безусловных 
							переходов.
						</td>
					</tr>
					<tr>
						<td style="color:red;">Красный цвет</td>
						<td>
							Используется для операторов, которые точно приведут 
							к остановке по ошибке.
						</td>
					</tr>
				</table>
				Если флаг подсветки не установлен, то будет вывод обычным цветом 
				текста.
			</li>
			<li>
				<b>Числовые значения.</b> По умолчанию выключен. 
				Будут выведены только числовые коды
				операций, а не их псевдокоды. При этом два предыдущих флага
				сохраняют значения (с адресами или подсветкой).
			</li>
		</ul>
		<p>
			Но самое интересное &ndash; это конечно ввод программы. По кнопке 
			«Ввести в память» можно попытаться ввести текст, который сейчас
			находится в поле программы в программную память ПМК. Результат
			можно узнать, прочитав его обратно.
		</p>
		<p>
			Чтобы понять, как вводить программу, расскажу о работе парсера,
			который считывает команды. Он сделан так, чтобы максимально 
			упростить ввод, в то же время учитывает множество разных вариантов 
			ввода. При это оформление текста игнорируется (цвет, шрифт), а
			используется только текст.
		</p>
		<ol>
			<li>
				Парсер считает командами всё, что разделено пробелами 
				(или концом строки). Т. е. псевдокод команды не должен содержать 
				пробелы. И формально можно все команды указать в одну строку.
			</li>
			<li>
				Парсер воспримет только первые 105 команд, остальные 
				проигнорирует. Если команд меньше, то оставшиеся место будет 
				безусловно заполнено нулями (как делает ПМК при включении).
			</li>
			<li>
				Парсер игнорирует регистр букв. Т. е. можно вводить в верхнем, 
				нижнем или смешанном режиме &ndash; всё распознается.
			</li>
			<li>
				Он считает одинаковыми все буквы, которые визуально похожи 
				в английском и русском алфавитах. Т. е. можно вводить в смешанном 
				режиме, всё равно парсер разберётся. Конкретно буквы 
				(приведены только русские) А, В, С, Е, З, К, М, О, Х, Д. 
				Последнюю он будет считать как букву D (регистр Д). Буква О 
				(русская или английская) и нуль также не отличаются 
				при разборе. Т. е. используйте «что ближе». Буква «З» и цифра
				3 тоже взаимозаменяемы.
			</li>
			<li>
				Вместо псевдокода можно использовать цифровой код команды. 
				В этом случае он должен состоять минимум из двух цифр, чтобы
				отличить от ввода обычной цифры.
			</li>
			<li>
				Каждая команда может содержать префикс адреса в виде «nn.», 
				т. е. в виде адреса с точкой. В этом случае команда будет
				помещена по этому адресу, а все последующие (без префикса) 
				последовательно после неё. Понятно, что первая команда 
				по умолчанию идёт по нулевому адресу. Для адреса после 99
				допустимо «A0.», «&minus;0.», «.0.».
			</li>
		</ol>
		<p>
			Далее опишем псевдокоды, которые понимает парсер. В первой колонке
			идёт текст команды (или одна из возможных, если похожих операций
			несколько), каким она будет представлена при выводе, а далее 
			(через пробелы)
			возможные варианты ввода, уже не включая вариант из первой колонки. 
			Не забывайте про правила 3 и 4 выше, т. е. 
			я использую далее более удобную форму, а могут быть все варианты с
			учётом этих правил.
		</p>
		<table>
			<tr>
				<th>Вывод</th>
				<th>Допустимо</th>
				<th>Комментарий</th>
			</tr>
			<tr>
				<td>F10ˣ</td>
				<td>10ˣ&emsp;F10^x&emsp;10x&emsp;F10x&emsp;10**x</td>
				<td></td>
			</tr>
			<tr>
				<td>КНОП</td>
				<td>K0</td>
				<td></td>
			</tr>
			<tr>
				<td>Feˣ</td>
				<td>Eˣ&emsp;FE^x&emsp;E^x&emsp;Ex&emsp;FEx&emsp;FE**x&emsp;E**x</td>
				<td>
					По стандарту UNICODE есть два разных варианта верхнего 
					индекса x, понимаются оба.
				</td>
			</tr>
			<tr>
				<td>Flg</td>
				<td>Lg</td>
				<td></td>
			</tr>
			<tr>
				<td>Fln</td>
				<td>Ln</td>
				<td></td>
			</tr>
			<tr>
				<td>KЧ→М</td>
				<td>KЧM&emsp;ЧM&emsp;K3</td>
				<td>
					Перевод угловых или временных величин из части целого в 
					обычную форму, включая секунды.
				</td>
			</tr>
			<tr>
				<td>Fsinᐨ¹</td>
				<td>SINᐨ¹&emsp;Fsin-1&emsp;sin-1&emsp;Farcsin&emsp;arcsin</td>
				<td>
					По стандарту UNICODE есть два разных варианта верхнего 
					&minus;1, понимаются оба.
				</td>
			</tr>
			<tr>
				<td>K|x|</td>
				<td>|X|&emsp;K4</td>
				<td></td>
			</tr>
			<tr>
				<td>Fcosᐨ¹</td>
				<td>cosᐨ¹&emsp;Fcos-1&emsp;cos-1&emsp;Farccos&emsp;arccos</td>
				<td>
					По стандарту UNICODE есть два разных варианта верхнего 
					&minus;1, понимаются оба.
				</td>
			</tr>
			<tr>
				<td>Кзн</td>
				<td>3H&emsp;K5</td>
				<td>
					В частности по правилам выше допустимо 3h, где 3 &ndash; 
					это цифра
				</td>
			</tr>
			<tr>
				<td>KГ→М</td>
				<td>Г→M&emsp;KГM&emsp;ГM&emsp;K6</td>
				<td>
					Перевод угловых или временных величин из части целого в 
					обычную форму.
				</td>
			</tr>
			<tr>
				<td>Fsin</td>
				<td>sin</td>
				<td></td>
			</tr>
			<tr>
				<td>K[x]</td>
				<td>[x]&emsp;K7</td>
				<td></td>
			</tr>
			<tr>
				<td>Fcos</td>
				<td>cos</td>
				<td>
					В частности «C0s», где первая «С» русская, а вторая цифра 
					нуль, тоже допустимо.
				</td>
			</tr>
			<tr>
				<td>K{x}</td>
				<td>{x}&emsp;(x)&emsp;K(x)&emsp;K8</td>
				<td></td>
			</tr>
			<tr>
				<td>Ftg</td>
				<td>tg</td>
				<td></td>
			</tr>
			<tr>
				<td>Kmax</td>
				<td>max&emsp;K9</td>
				<td></td>
			</tr>
			<tr>
				<td>+</td>
				<td></td>
				<td>Плюс бывает только один.</td>
			</tr>
			<tr>
				<td>-</td>
				<td>–&emsp;–</td>
				<td>А вот минус может быть «Hyphen», «Dash», «En Dash».</td>
			</tr>
			<tr>
				<td>К-</td>
				<td>K–&emsp;K–</td>
				<td>Приводит к ошибке. Минусы могут разные, как указано выше.</td>
			</tr>
			<tr>
				<td>×</td>
				<td>⋅&emsp;X&emsp;*</td>
				<td>Это умножение.</td>
			</tr>
			<tr>
				<td>K×</td>
				<td>K⋅&emsp;KX&emsp;K*</td>
				<td>Приводит к ошибке.</td>
			</tr>
			<tr>
				<td>÷</td>
				<td>/&emsp;:</td>
				<td></td>
			</tr>
			<tr>
				<td>K÷</td>
				<td>K/&emsp;K:</td>
				<td>Приводит к ошибке.</td>
			</tr>
			<tr>
				<td>Fπ</td>
				<td>FΠ&emsp;Π&emsp;Fпи;&emsp;пи;</td>
				<td>П русская</td>
			</tr>
			<tr>
				<td>KМ→Г</td>
				<td>M→Г&emsp;KMГ&emsp;MГ&emsp;K+</td>
				<td>
					Перевод угловых или временных величин из обычной формы в 
					часть целой.
				</td>
			</tr>
			<tr>
				<td>F√</td>
				<td>√&emsp;квкор&emsp;Fквкор&emsp;корень&emsp;квкорень&emsp;Fкорень&emsp;Fквкорень</td>
				<td></td>
			</tr>
			<tr>
				<td>Fx²</td>
				<td>X^2&emsp;X2&emsp;X²&emsp;FX^2&emsp;FX2</td>
				<td></td>
			</tr>
			<tr>
				<td>F1/x</td>
				<td>1/x</td>
				<td></td>
			</tr>
			<tr>
				<td>&lt;-&gt;</td>
				<td>↔&emsp;XY&emsp;X↔Y&emsp;⟷</td>
				<td></td>
			</tr>
			<tr>
				<td>В&uarr;</td>
				<td>^&emsp;B^&emsp;&uarr;</td>
				<td></td>
			</tr>
			<tr>
				<td>x←y</td>
				<td></td>
				<td>
					Недокументированная команда с кодом 3E. 
					Смысл ясен из обозначения.
				</td>
			</tr>
			<tr>
				<td>Fxʸ</td>
				<td>Xʸ&emsp;FX^Y&emsp;X^Y&emsp;FXY</td>
				<td>Обратите внимание, что XY это уже другая команда.</td>
			</tr>
			<tr>
				<td>KМ→Ч</td>
				<td>M→Ч&emsp;KMЧ&emsp;MЧ</td>
				<td>
					Перевод угловых или временных величин из обычной формы в 
					часть целой, включая секунды.
				</td>
			</tr>
			<tr>
				<td>FВх</td>
				<td>ВX</td>
				<td></td>
			</tr>
			<tr>
				<td>KCЧ</td>
				<td>CЧ&emsp;KE</td>
				<td></td>
			</tr>
			<tr>
				<td>.</td>
				<td>,&emsp;•</td>
				<td></td>
			</tr>
			<tr>
				<td>/-/</td>
				<td>+/-&emsp;/–/&emsp;/–/</td>
				<td>«Hyphen», «Dash», «En Dash»</td>
			</tr>
			<tr>
				<td>ВП</td>
				<td></td>
				<td>Без вариантов.</td>
			</tr>
			<tr>
				<td>Cx</td>
				<td></td>
				<td>Без вариантов.</td>
			</tr>
			<tr>
				<td>Fѻ</td>
				<td>FѺ&emsp;Ѻ&emsp;F↻&emsp;-&gt;&emsp;↻&emsp;→&emsp;F-&gt;&emsp;F→</td>
				<td></td>
			</tr>
			<tr>
				<td>KɅ</td>
				<td>K^&emsp;K⋀&emsp;K∧&emsp;∧&emsp;K/\&emsp;/\&emsp;⋀&emsp;K.&emsp;KA&emsp;KΛ</td>
				<td>
					В UNICODE много разных «крышечек». 
					Тут есть сочетание двух обычных наклонных черт.
				</td>
			</tr>
			<tr>
				<td>KV</td>
				<td>Kv&emsp;Kv&emsp;K∨&emsp;∨&emsp;K\/&emsp;\/&emsp;⋁&emsp;K/-/&emsp;KB</td>
				<td>То же, что выше.</td>
			</tr>
			<tr>
				<td>K(+)</td>
				<td>K⊕&emsp;(+)&emsp;⊕&emsp;KBП&emsp;KC</td>
				<td></td>
			</tr>
			<tr>
				<td>Kинв</td>
				<td>ИHB&emsp;KCX&emsp;KD</td>
				<td></td>
			</tr>
			<tr>
				<td>В/О</td>
				<td></td>
				<td>
					Без вариантов. Спор о том, что в конце <b>о</b>братно или 
					нуль отсекается правилом 4.
				</td>
			</tr>
			<tr>
				<td>С/П</td>
				<td></td>
				<td>Без вариантов</td>
			</tr>
			<tr>
				<td>БП</td>
				<td></td>
				<td>При косвенном добавляется K.</td>
			</tr>
			<tr>
				<td>ПП</td>
				<td></td>
				<td>При косвенном добавляется K.</td>
			</tr>
			<tr>
				<td>Fx≥0</td>
				<td>X&gt;=0&emsp;X≥0&emsp;X⩾0&emsp;FX⩾0&emsp;FX&gt;=0</td>
				<td>Для косвенной вместо F используется K.</td>
			</tr>
			<tr>
				<td>Fx≠0</td>
				<td>X#0&emsp;X!=0&emsp;X&lt;&gt;0&emsp;FX#0&emsp;FX!=0&emsp;FX&lt;&gt;0</td>
				<td>Для косвенной вместо F используется K.</td>
			</tr>
			<tr>
				<td>FL0</td>
				<td>L0</td>
				<td>То же самое для 1, 2 и 3</td>
			</tr>
			<tr>
				<td>Fx&lt;0</td>
				<td>FX&lt;0&emsp;X&lt;0</td>
				<td>Для косвенной вместо F используется K.</td>
			</tr>
			<tr>
				<td>Fx=0</td>
				<td>x=0</td>
				<td>Для косвенной вместо F используется K.</td>
			</tr>
			<tr>
				<td>xПR</td>
				<td>x→ПR&emsp;ПR</td>
				<td>
					Для буквенных регистров R при выводе используются 
					заглавные английские буквы. При косвенном добавляется
					буква K.
				</td>
			</tr>
			<tr>
				<td>ПxR</td>
				<td>П→xR&emsp;ИПR</td>
				<td>
					Для буквенных регистров R при выводе используются 
					заглавные английские буквы. При косвенном добавляется
					буква K.
				</td>
			</tr>
		</table>
		<p>
			Кроме того, если первой строкой является
			«# | 00 01 02 03 04 05 06 07 08 09» с любыми пробельными символами,
			то она игнорируется. В некоторых таблицах с текстами программ это 
			обозначало заголовок с адресацией.
		</p>
		<p>
			Если вначале строки стоит номер и «|», например «20 | FL1», то
			это воспринимается как 20.FL1. Причины те же, что выше &ndash; воспринимать
			текст из ранее опубликованных программ, где первая колонка обозначает
			адресацию.
		</p>
	</section>
	
</body>
	
</html>
